\chapter{Output}
This chapter describes the output of the code.
The first section those that is common to both versions of the code, the
second those of the parallel version, and the last section will describe
the output of the quasilinear version.
For each file there is a subsection. The main groups of hdf5 files are
described in paragraphs.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Both}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Parallel version}

\subsection{amat\_after.dat}
\subsection{amat\_before.dat}

\subsection{bvec\_after.dat}
\subsection{bvec\_before.dat}
\subsection{bvec\_solution.dat}
\subsection{collop.h5}
Written in \file{collision\_operator\_mems.f90}.

\subsection{collpar.dat}

\subsection{efinal.h5}

\subsection{eta\_m.dat}
\subsection{eta\_ori.dat}
\subsection{eta\_p.dat}

\subsection{evolve.h5}

\subsection{fin\_dims.dat}
\subsection{fin\_flux\_m.dat}
\subsection{fin\_flux\_p.dat}

\subsection{fin\_source\_m.dat}
\subsection{fin\_source\_p.dat}

\subsection{fulltransp.h5}
This contains the input parameters ``lag'' and ``leg'', which is a point
to remember when comparing files of different runs (especially
convergence tests/scans).

\paragraph{k\_cof}
Related to a integration constant in the expression for the parallel
flow. For definition see below Eq. (2.26) in \cite{Martitsch:Thesis:16}.

\subsection{magnetics.h5}
\paragraph{device}
\paragraph{fieldline}
\paragraph{fieldperiod}
\paragraph{fieldpropagator}
\paragraph{fieldripple}
\paragraph{general}
\paragraph{surface}

\subsection{MatrixD\_mmp-gee.dat}
\subsection{MatrixI\_mmp-gee.dat}
\subsection{MatrixNu\_mmp-gee.dat}
\subsection{MatrixNu\_mmp-ginf.dat}

\subsection{neo2\_config.h5}
Contains the settings (from neo2.in) of the run, as well as the hash of
the git version from which the code was build. To support this, also
some of the cmake build variables are included.
This means some of the fields (the /metadata group) should be
excluded when comparing different runs.

The namelists are recreated as groups.

\subsection{phi\_placement\_problem.dat}

\subsection{qfmin1.dat}
\subsection{qfmin2.dat}
\subsection{qfmin3.dat}
\subsection{qfplu1.dat}
\subsection{qfplu2.dat}
\subsection{qfplu3.dat}

\subsection{SourceAa123m\_Cm.dat}

\subsection{taginfo.h5}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Quasilinear version}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{collop.h5}
Written in \file{collision\_operator\_mems.f90}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{efinal.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{efinal.h5}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{eta\_ori.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{evolve.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{fluxsurface.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{fulltransp.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{fulltransp.h5}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{MatrixD\_mmp-gee.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{MatrixI\_mmp-gee.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{MatrixNu\_mmp-gee.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{MatrixNu\_mmp-ginf.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{neo2\_config.h5}
Contains some/most of the neo2 input parameters.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{neo2\_multispecies\_out.h5}
Output of (normalized) diffusion coefficients. Also the normalization
constants and the not normalized values are writen to this file, as well
as the quantities $E_r$ and $\fa{E_{\parallel} B}/\fa{B^2}$,
required for calculating the fluxes.
Note that both quantities require \inputparameter{isw\_calc\_Er} to be
$=1$ and the latter additionally requires \inputparameter{nu\_spec} to be
greater as one.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{precomp\_collop.h5}
This file is produced as a result of the precomputation, i.e. with
\inputparameter{collision::LSW\_READ\_PRECOM} false and
\inputparameter{collision::LSW\_WRITE\_PRECOM} true. If the settings are
reverted, then this will be an input.
Note that the code will complain if the temperatures used for
precomputation and computation differ.

Written in \file{collision\_operator\_mems.f90}.

\paragraph{Amm}

\paragraph{C\_m}

\paragraph{M\_transform\_}

\paragraph{M\_transform\_inv}

\paragraph{ailmm\_aa}

\paragraph{anumm\_aa}

\paragraph{asource}

\paragraph{denmm\_aa}

\paragraph{meta}
Here the values of some of the input variables are documented.

\paragraph{version}

\paragraph{weightden}

\paragraph{weightdenerg}

\paragraph{weightlag}

\paragraph{weightparflow}

\paragraph{x1mm}

\paragraph{x2mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{qflux\_ntv\_allspec.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{qflux\_symm\_allspec.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{sigma\_alex.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{SourceAa123m\_Cm.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{*.sp.chk.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{*.sp.cur.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{*.sp.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{*.sp.log.dat}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{How to read/edit the in/output}
This section will briefly describe the possibilities to read and edit
the input and output of \neotwo.

In table~\ref{tablereadinginoutput} is an overview of the formats used
for input and output, along with usual ending and the possibilities to
edit these with other programs.

\begin{table}
  \begin{center}
    \begin{tabular}{cccccc}
kind of in-/output & in/out & matlab & octave & python3 & texteditor \\
data (text, dat)   & out    & yes    & yes    & yes     & yes \\
boozer (bc)        & in     &        &        &         & yes$^2$ \\
netcdf (nc)$^4$    &        &        &        &         & no \\
hdf5 (h5)          & in/out & yes    & yes$^3$&         & no$^1$ \\
fortran namelist$^5$&in/out &        &        &         & yes$^2$ \\
efit               & in     &        &        &         & yes$^2$
    \end{tabular}
    \caption{Possibilities to read/write/edit the different in-/output
file formats of \neotwo.
$^1$ the program \program{hdf5view} can be used to read/edit hdf5 files.
$^2$ This requires some care, e.g. about what changes are possible, what
side effects might occour.
$^3$ At the moment of writing this, octave is not capable of reading
just parts of hdf5 files, thus it can not be recommended for files
larger than the main memory.
$^4$ The netcdf format is currently not in use in \neotwo, but as it has
been used at some point, it is listed here.
$^5$ Meant is here specifically the \neotwo configuration file.}
    \label{tablereadinginoutput}
  \end{center}
\end{table}

Data files are asssumed to be text files with only numbers arranged in
rows and columns. Each row and column has the same number of entries,
there are no special lines.
They are easy to read and edit in almost any program.

Boozer files are text files, which contain magnetic fiels data in a
specific format. There are header information and multiple blocks, where
each block also has a header.
They can be read with a texteditor. The data can in principle be edited,
but changes in size are non-trivial.

Hdf5 is binary format, which allows to store data in a directory like
structure. Additionally the entries can have comments, e.g. indicating
type, unit of measurement or details of computation.
Hdf5 files can be read and written by matlab and octave. Python probably
has a module for this. There exists also the tool \program{hdfview},
delivered with the hdf5 library, which allows to read and edit this
filetype.
Note that some output files may contain size information in some of the
fields, which makes resizing a bit more complicated.

Netcdf is a binary container format and as such similar to hdf5. At the
moment it is not used by \neotwo, neither as input nor as output, but as
it has been used as an output format in the past, it is listed here.

Fortran namelists are mainly used as inputs, but in some cases there are
also output. As textfiles they can in principle, be edited with a
texteditior, but care must be taken with dependencies among the input
parameters.

Efit files contain magnetic field information (like boozer files) in
real space (unlike boozer files) in a specific format (which differs
from the format used by boozer files). These files can be viewed with
a texteditor, but as the file makes not clear which number is which
parameter, it is not recommended to edit efit files with a texteditor.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{How to compute dimensionless quantities from the output}
This section will describe, how to get dimensionless quantities from the
\neotwo output. As the relevant quantities and how they are normalized
differs between the both device types, they are treated seperately.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Tokamak}

\paragraph{Transport coefficients}
The transport coefficients $D_{ij}$ link the thermodynamic forces with
the thermodynamik fluxes. Two different normalization constants are
used.
The plateau diffusion coefficient
\begin{equation}
  D_p = \frac{\pi q v_T \rho_L^2}{16 R}
\end{equation}
is used if neither index is equal to three. In case of the indices is
equal to three (e.g. $D_{13}$), then the Ware pinch coefficient  for the
axisymmetric field
\begin{equation}
  D_{13}^{AX} = \frac{cT_i B_{\phi}}{e_i \sqrt{g} B^{\theta}}
\end{equation}
is used for normalization.
If calculated, these two quantities are written to the file
\file{neo2\_multispecies\_out.h5}.

%~ For multispecies runs, the most interesting file is
%~ \file{neo2\_multispecies\_out.h5}. It contains the elements $D_{ij}$ of
%~ the transport matrix. Each element is seperated into an axisymmetric
%~ part (AX) and an non-axisymmetric part (NA). Each of these is given in
%~ normalized and not normalized form.
%~ To compute from these the fluxes, the thermodynamic forces are required.
%~ For the computation of these, some more quantities are necessary. These
%~ are either obtainable from the same file, or from the input
%~ (\file{neo2\_config.h5}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Stellerator}

%~ \begin{figure}[thb]
%~ \begin{center}
%~ \includegraphics[width=12 truecm,clip]{heatflux.eps}
%~ \caption{GKW results of the electron heat flux expressed as a heat conduction coefficient (normalised
%~ to $\rho_e^2  c_e / L_T$ with $c_e = \sqrt{T_e/m_e}$) as a function of normalised time ($t_{NN} = tc_e/L_T$)
%~ for the Nevins ETG benchmark}
%~ \label{cyclone-nl}
%~ \end{center}
%~ \end{figure}
